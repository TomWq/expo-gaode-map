# LBS åœºæ™¯æ¨è

æœ¬æ–‡æ¡£å±•ç¤ºäº†å¦‚ä½•ç»“åˆ `expo-gaode-map`ï¼ˆæ ¸å¿ƒæ¸²æŸ“ï¼‰å’Œ `expo-gaode-map-web-api`ï¼ˆæ•°æ®æœåŠ¡ï¼‰æ¥å®ç°å¸¸è§çš„ä¸šåŠ¡åœºæ™¯ã€‚

## ğŸ— ç»„ä»¶èŒè´£åˆ†å·¥

åœ¨é˜…è¯»åŠŸèƒ½åˆ—è¡¨å‰ï¼Œè¯·å…ˆç†è§£ä¸¤ä¸ªç»„ä»¶çš„è§’è‰²ï¼š

*   **ğŸ“± expo-gaode-map (Core)**
    *   **è§’è‰²**ï¼šå‰ç«¯æ¸²æŸ“å±‚ï¼ˆViewï¼‰
    *   **èŒè´£**ï¼šæ˜¾ç¤ºåœ°å›¾ã€å®šä½ã€ç»˜åˆ¶æ ‡è®°/çº¿æ¡ã€å¤„ç†æ‰‹åŠ¿äº¤äº’ã€‚
    *   **ç‰¹ç‚¹**ï¼šåŸç”Ÿæ€§èƒ½ï¼Œæ‰€è§å³æ‰€å¾—ã€‚

*   **â˜ï¸ expo-gaode-map-web-api (Web API)**
    *   **è§’è‰²**ï¼šåç«¯æ•°æ®å±‚ï¼ˆModel/Serviceï¼‰
    *   **èŒè´£**ï¼šåœ°ç†ç¼–ç ã€è·¯å¾„è§„åˆ’ç®—æ³•ã€POI æ•°æ®æœç´¢ã€è¾“å…¥æç¤ºã€‚
    *   **ç‰¹ç‚¹**ï¼šçº¯ JS å®ç°ï¼Œè´Ÿè´£é€»è¾‘è®¡ç®—ä¸æ•°æ®è·å–ã€‚

---

## ğŸš€ æ ¸å¿ƒåœºæ™¯æ¨è

### 1. ğŸ“ å®šä½ä¸åœ°å€è§£æ (Location & Geocoding)
*åŸºç¡€ LBS èƒ½åŠ›ï¼Œé€‚ç”¨äºå‡ ä¹æ‰€æœ‰åœ°å›¾åº”ç”¨ã€‚*

| åŠŸèƒ½åç§° | æµç¨‹é€»è¾‘ (Core + Web API) | åº”ç”¨åœºæ™¯ |
| :--- | :--- | :--- |
| **ç²¾å‡†å®šä½ä¸å±•ç¤º** | Core è·å–ç»çº¬åº¦ -> Core ç§»åŠ¨è§†è§’å¹¶æ˜¾ç¤ºè“ç‚¹ | æ‰“è½¦/å¤–å– App é¦–é¡µ |
| **é€†åœ°ç†ç¼–ç  (ReGeocode)** | Core è·å–åæ ‡ -> Web API è§£æä¸ºä¸­æ–‡åœ°å€("æœé˜³åŒº...") -> UI æ˜¾ç¤º | æœ‹å‹åœˆå®šä½ã€ç­¾åˆ°ã€ä¸Šè½¦ç‚¹ç¡®è®¤ |
| **åœ°ç†ç¼–ç  (Geocode)** | ç”¨æˆ·è¾“å…¥åœ°å€æ–‡å­— -> Web API è§£æä¸ºåæ ‡ -> Core è·³è½¬å¹¶æ ‡è®° | åœ°å€é€‰ç‚¹ã€ç›®çš„åœ°è¾“å…¥ |
| **æ‹–æ‹½é€‰ç‚¹** | Core æ˜¾ç¤ºä¸­å¿ƒå›ºå®š Marker -> ç”¨æˆ·æ‹–åŠ¨åœ°å›¾ -> Web API å®æ—¶è§£æä¸­å¿ƒç‚¹åœ°å€ | å«è½¦èµ·ç‚¹å¾®è°ƒã€å¤–å–åœ°å€ä¿®æ”¹ |

### 2. ğŸ” æœç´¢ä¸å‘ç° (Search & POI)
*åˆ©ç”¨é«˜å¾·æµ·é‡ POI æ•°æ®è¿›è¡Œåœ°ç‚¹æ£€ç´¢ã€‚*

| åŠŸèƒ½åç§° | æµç¨‹é€»è¾‘ (Core + Web API) | åº”ç”¨åœºæ™¯ |
| :--- | :--- | :--- |
| **å…³é”®å­—æœç´¢** | ç”¨æˆ·è¾“å…¥å…³é”®å­— -> Web API è¿”å› POI åˆ—è¡¨ -> Core åœ¨åœ°å›¾ä¸Šæ’’ç‚¹ | æ‰¾é¤å…ã€æ‰¾é…’åº— |
| **å‘¨è¾¹æœç´¢ (Around)** | Core è·å–å½“å‰ä¸­å¿ƒç‚¹ -> Web API æœ"åŠ æ²¹ç«™" -> Core æ¸²æŸ“ç»“æœ | é™„è¿‘è®¾æ–½æŸ¥è¯¢ |
| **è¾“å…¥æç¤º (Input Tips)** | ç”¨æˆ·è¾“å…¥"ä¸‡" -> Web API å®æ—¶è¿”å›"ä¸‡è¾¾ã€ä¸‡ç§‘..."åˆ—è¡¨ -> ç‚¹å‡»å Core è·³è½¬ | æœç´¢æ¡†è”æƒ³ä¼˜åŒ– |
| **å¤šè¾¹å½¢åŒºåŸŸæœç´¢** | Core ç»˜åˆ¶ Polygon åŒºåŸŸ -> Web API æœç´¢è¯¥åŒºåŸŸå†…çš„ POI | æ‰¾ç‰¹å®šå•†åœˆå†…çš„æˆ¿æº |

### 3. ğŸš— è·¯å¾„è§„åˆ’ä¸å¯¼èˆª (Routing)
*Web API è´Ÿè´£"æ€ä¹ˆèµ°"ï¼ŒCore è´Ÿè´£"ç”»å‡ºæ¥"ã€‚*

| åŠŸèƒ½åç§° | æµç¨‹é€»è¾‘ (Core + Web API) | åº”ç”¨åœºæ™¯ |
| :--- | :--- | :--- |
| **é©¾è½¦è·¯çº¿è§„åˆ’** | Web API è®¡ç®—è·¯çº¿(å«é¿å µç­–ç•¥) -> Core ç»˜åˆ¶ `Polyline` è½¨è¿¹ | ç½‘çº¦è½¦è¡Œç¨‹é¢„è§ˆ |
| **å¤šç­–ç•¥å¯¹æ¯”** | Web API è¿”å›3æ¡è·¯çº¿(æœ€å¿«/æœ€çŸ­/çœé’±) -> Core ç»˜åˆ¶3æ¡ä¸åŒé¢œè‰²çº¿æ¡ | ç”¨æˆ·é€‰è·¯ |
| **è·¯å†µå¯è§†åŒ–** | Web API è¿”å›è·¯å†µæ•°æ® -> Core ç”¨ çº¢/é»„/ç»¿ åˆ†æ®µç»˜åˆ¶çº¿æ¡ | æ‹¥å µæƒ…å†µå±•ç¤º |
| **å…¬äº¤/åœ°é“è§„åˆ’** | Web API è®¡ç®—æ¢ä¹˜æ–¹æ¡ˆ -> Core ç»˜åˆ¶åˆ†æ®µè½¨è¿¹(æ­¥è¡Œè™šçº¿/å…¬äº¤å®çº¿) | åŸå¸‚å…¬å…±äº¤é€šå‡ºè¡Œ |
| **æ­¥è¡Œ/éª‘è¡Œè§„åˆ’** | Web API è®¡ç®—çŸ­é€”è·¯çº¿ -> Core ç»˜åˆ¶è½¨è¿¹å¹¶æ˜¾ç¤ºå…³é”®è½¬å¼¯ç‚¹ | æœ€åä¸€å…¬é‡Œå¯¼èˆª |

### 4. ğŸ—ºï¸ é«˜çº§æ•°æ®å¯è§†åŒ– (Visualization)
*å¤„ç†å¤§é‡æ•°æ®æˆ–ç‰¹å®šä¸šåŠ¡æ•°æ®çš„å±•ç¤ºã€‚*

| åŠŸèƒ½åç§° | æµç¨‹é€»è¾‘ (Core + Web API) | åº”ç”¨åœºæ™¯ |
| :--- | :--- | :--- |
| **æµ·é‡ç‚¹èšåˆ (Cluster)** | Web API è·å–å…¨å¸‚ 5000+ æ•°æ® -> Core ä½¿ç”¨ `Cluster` ç»„ä»¶èšåˆæ˜¾ç¤º | å…±äº«å•è½¦ã€æˆ¿äº§ä¸­ä»‹ |
| **çƒ­åŠ›å›¾ (HeatMap)** | Web API è·å–äººæµé‡æ•°æ® -> Core æ¸²æŸ“çƒ­åŠ›å›¾å±‚ | æ™¯åŒºç›‘æ§ã€å•†ä¸šé€‰å€ |
| **ç”µå­å›´æ /æœåŠ¡åŒº** | Web API è·å–è¡Œæ”¿åŒºè¾¹ç•Œ -> Core ç»˜åˆ¶ `Polygon` å¤šè¾¹å½¢ | é…é€èŒƒå›´ã€ç¦é£åŒºå±•ç¤º |
| **è½¨è¿¹å›æ”¾** | åç«¯è®°å½•åæ ‡ä¸² -> Core åŠ¨æ€ç§»åŠ¨ Marker å¹¶ç»˜åˆ¶å·²èµ°è¿‡çš„è½¨è¿¹ | è·‘æ­¥è®°å½•ã€è½¦è¾†è¿½è¸ª |

### 5. ğŸ¢ è¡Œä¸šå‚ç›´åœºæ™¯ (Industry Solutions)
*é’ˆå¯¹ç‰¹å®šè¡Œä¸šçš„æ·±åº¦åº”ç”¨ã€‚*

| åŠŸèƒ½åç§° | æµç¨‹é€»è¾‘ (Core + Web API) | åº”ç”¨åœºæ™¯ |
| :--- | :--- | :--- |
| **æˆ¿äº§/å­¦åŒºå¯è§†åŒ–** | Web API æœç´¢"å°å­¦" -> Core ç»˜åˆ¶å­¦æ ¡ä½ç½® + Core ç»˜åˆ¶å­¦åŒºèŒƒå›´ Polygon | æˆ¿äº§ä¸­ä»‹ App |
| **ç‰©æµå¤šç‚¹æ’çº¿** | Web API æ‰¹é‡ç®—è·¯(TSPé—®é¢˜) -> Core ç»˜åˆ¶æœ€ä¼˜é…é€é¡ºåºè½¨è¿¹ | å¿«é€’/å¤–å–é…é€å‘˜ç«¯ |
| **ç½‘æ ¼åŒ–ç®¡ç†** | Web API è·å–è¡Œæ”¿åŒºè¾¹ç•Œ -> Core ç»˜åˆ¶ç½‘æ ¼ Polygon + ä¸åŒé¢œè‰²è¡¨ç¤ºçŠ¶æ€ | æ™ºæ…§åŸå¸‚/åŸç®¡ |
| **ä½ç½®ç­¾åˆ°æ‰“å¡** | Core è·å–å®šä½ + Web API é€†åœ°ç†ç¼–ç  + Web API åˆ¤æ–­æ˜¯å¦åœ¨ Polygon èŒƒå›´å†… | åŠå…¬è€ƒå‹¤ã€å¤–å‹¤ç®¡ç† |

### 6. ğŸ¨ äº¤äº’ä½“éªŒå¢å¼º (UX Enhancement)
*æå‡ç”¨æˆ·æ“ä½œåœ°å›¾çš„ç»†è…»ä½“éªŒã€‚*

| åŠŸèƒ½åç§° | æµç¨‹é€»è¾‘ (Core + Web API) | åº”ç”¨åœºæ™¯ |
| :--- | :--- | :--- |
| **å¹³æ»‘ç§»åŠ¨ Marker** | Web API è¿”å›è½¦è¾†æ–°åæ ‡ -> Core ä½¿ç”¨ `Camera` æˆ– Marker åŠ¨ç”» API å¹³æ»‘ç§»åŠ¨å›¾æ ‡ | è½¦è¾†å®æ—¶è¿½è¸ª |
| **åŠ¨æ€ç¼©æ”¾è§†é‡** | Web API è¿”å›æœç´¢ç»“æœåˆ—è¡¨ -> Core è®¡ç®—æ‰€æœ‰ç‚¹çš„è¾¹ç•Œ -> è‡ªåŠ¨ç¼©æ”¾åœ°å›¾ä»¥åŒ…å«æ‰€æœ‰ç‚¹ | æœç´¢ç»“æœå±•ç¤º |
| **è‡ªå®šä¹‰ä¿¡æ¯çª—ä½“** | ç‚¹å‡» Marker -> Core å¼¹å‡ºçš„ Callout ä¸­å±•ç¤ºç”± Web API è·å–çš„å®æ—¶æ•°æ®(å¦‚æ’é˜Ÿäººæ•°) | çƒ­é—¨é¤å…æŸ¥çœ‹ |

### 7. ğŸ›  è¾…åŠ©å·¥å…· (Utilities)
*åˆ©ç”¨åœ°å›¾æ•°æ®è¿›è¡Œçš„è¾…åŠ©è®¡ç®—ã€‚*

| åŠŸèƒ½åç§° | æµç¨‹é€»è¾‘ (Core + Web API) | åº”ç”¨åœºæ™¯ |
| :--- | :--- | :--- |
| **è·ç¦»æµ‹é‡å·¥å…·** | Core è®°å½•ç”¨æˆ·ç‚¹å‡»çš„å¤šä¸ªåæ ‡ç‚¹ -> å‡ ä½•è®¡ç®—æˆ– Web API ç®—è·¯ -> UI æ˜¾ç¤ºæ€»é•¿åº¦ | æˆ·å¤–è¿åŠ¨è§„åˆ’ |
| **é¢ç§¯æµ‹é‡å·¥å…·** | Core è®°å½•ç”¨æˆ·ç‚¹å‡»æ„æˆçš„å¤šè¾¹å½¢ -> å‡ ä½•è®¡ç®—é¢ç§¯ -> UI æ˜¾ç¤º | åœŸåœ°æµ‹é‡ã€è£…ä¿®ä¼°ç®— |

---

## ğŸ’¡ æœ€ä½³å®è·µç¤ºä¾‹ï¼šæ‰“è½¦ App

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€åŒ–çš„æ‰“è½¦ App æ ¸å¿ƒæµç¨‹ç¤ºä¾‹ä»£ç ï¼š

```tsx
// 1. è·å–å®šä½
const location = await ExpoGaodeMapModule.getCurrentLocation();

// 2. é€†åœ°ç†ç¼–ç ï¼ˆæ˜¾ç¤ºå½“å‰ä½ç½®åç§°ï¼‰
const regeo = await api.geocode.regeocode({
  latitude: location.latitude,
  longitude: location.longitude
});
console.log("å½“å‰ä½ç½®:", regeo.regeocode.formatted_address);

// 3. æœç´¢ç›®çš„åœ°
const pois = await api.poi.search("åŒ—äº¬è¥¿ç«™", { city: "åŒ—äº¬" });
const destination = pois.pois[0];

// 4. è·¯å¾„è§„åˆ’ï¼ˆé©¾è½¦ï¼‰
const route = await api.route.driving(
  `${location.longitude},${location.latitude}`,
  `${destination.location}`,
  { strategy: DrivingStrategy.AVOID_JAM, show_fields: 'polyline,cost' }
);

// 5. æ¸²æŸ“åœ°å›¾
return (
  <MapView>
    {/* èµ·ç‚¹ */}
    <Marker position={location} title="æˆ‘çš„ä½ç½®" />
    
    {/* ç»ˆç‚¹ */}
    <Marker 
      position={{
        latitude: parseFloat(destination.location.split(',')[1]), 
        longitude: parseFloat(destination.location.split(',')[0])
      }} 
      title={destination.name} 
    />
    
    {/* è·¯çº¿ */}
    <Polyline 
      points={parseRoutePolyline(route.route.paths[0].steps)} 
      strokeColor="#0091FF" 
      strokeWidth={6} 
    />
  </MapView>
);
```
